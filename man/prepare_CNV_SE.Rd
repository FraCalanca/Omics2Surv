% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare_CNV_SE.R
\name{prepare_CNV_SE}
\alias{prepare_CNV_SE}
\title{Prepare Copy Number Variation Data as SummarizedExperiment}
\usage{
prepare_CNV_SE(
  cnv_data,
  clinical_data,
  variability_threshold = 0.25,
  method = NULL,
  p_threshold = NULL,
  top_n_supervised = NULL
)
}
\arguments{
\item{cnv_data}{A numeric matrix of CNV data where:
\itemize{
\item Rows represent genes/genomic regions
\item Columns represent samples
\item Values typically represent copy number states (e.g., -2, -1, 0, 1, 2)
or continuous copy number estimates
}}

\item{clinical_data}{A matrix or data frame of clinical data where:
\itemize{
\item Columns represent samples (matching \code{cnv_data} column names)
\item Rows represent clinical variables
\item Must include rows named \code{"overall_survival"} and \code{"status"}
if using supervised feature selection
}}

\item{variability_threshold}{Numeric value between 0 and 1 specifying the proportion
of most variable genes to retain when \code{method = "unsupervised"}. For example,
0.25 retains the top 25\\% most variable genes. Default is 0.25. Ignored if method
is not "unsupervised".}

\item{method}{Character string specifying the feature selection method. Options are:
\itemize{
\item \code{"supervised"}: Cox regression-based selection using survival outcomes
\item \code{"unsupervised"}: Variability-based selection (no outcome information)
\item \code{NULL}: No additional filtering beyond constant gene removal (default)
}
Default is NULL.}

\item{p_threshold}{Numeric p-value threshold for supervised feature selection.
Only genes with Cox regression p-values <= \code{p_threshold} are retained.
Required when \code{method = "supervised"}. Ignored otherwise. Default is NULL.}

\item{top_n_supervised}{Integer specifying the number of top genes to select if
fewer than 100 genes pass the p-value threshold in supervised selection. Acts as
a fallback to ensure a minimum number of features. Default is NULL.}
}
\value{
A SummarizedExperiment object containing:
\itemize{
\item \code{assays}: List with one element named "counts" containing the filtered
CNV matrix
\item \code{metadata}: List with preprocessing information:
\itemize{
\item \code{omics}: "CNV"
\item \code{method}: The feature selection method used
}
}
}
\description{
Processes copy number variation (CNV) data by filtering constant genes, optionally
performing feature selection using supervised (survival-based) or unsupervised
(variability-based) methods, and packaging the results into a SummarizedExperiment
object for downstream analysis.
}
\details{
The function performs the following processing steps:
\enumerate{
\item \strong{Sample alignment}: Identifies and retains only samples present in
both CNV and clinical data
\item \strong{Constant gene removal}: Removes genes with no variation across samples
(all values identical)
\item \strong{Feature selection} (optional):
\itemize{
\item \strong{Supervised}: Fits univariate Cox regression for each gene, retains
genes with p-value <= \code{p_threshold}. Uses parallel processing for speed.
Falls back to top N genes if < 100 pass threshold.
\item \strong{Unsupervised}: Calculates variability as sum of absolute CNV values,
retains top \code{variability_threshold} proportion of genes
}
\item \strong{SummarizedExperiment creation}: Packages filtered data with metadata
}
}
\seealso{
\code{\link[SummarizedExperiment]{SummarizedExperiment}} for the return object class
\code{\link[survival]{coxph}} for Cox regression in supervised selection
}
